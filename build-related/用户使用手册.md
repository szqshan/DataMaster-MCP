# ğŸ“š DataMaster MCP ç”¨æˆ·ä½¿ç”¨æ‰‹å†Œ

> **å®Œæ•´çš„æ•°æ®åˆ†æå·¥å…·ä½¿ç”¨æŒ‡å—** - ä»å…¥é—¨åˆ°ç²¾é€š

---

## ğŸ¯ å¿«é€Ÿå¼€å§‹

### å®‰è£…ä¾èµ–

```bash
pip install -r requirements.txt
```

### å¯åŠ¨æœåŠ¡

```bash
python main.py
```

---

## ğŸ“Š æ ¸å¿ƒåŠŸèƒ½æ¦‚è§ˆ

### ğŸ”— æ•°æ®æºè¿æ¥
- **Excel/CSVæ–‡ä»¶å¯¼å…¥** - æ”¯æŒå¤šç§æ ¼å¼å’Œç¼–ç 
- **æ•°æ®åº“è¿æ¥** - MySQLã€PostgreSQLã€MongoDBã€SQLite
- **APIæ•°æ®è·å–** - RESTful APIè¿æ¥å’Œæ•°æ®æå–

### ğŸ” æ•°æ®æŸ¥è¯¢åˆ†æ
- **SQLæŸ¥è¯¢æ‰§è¡Œ** - æœ¬åœ°å’Œå¤–éƒ¨æ•°æ®åº“æŸ¥è¯¢
- **æ•°æ®ç»Ÿè®¡åˆ†æ** - åŸºç¡€ç»Ÿè®¡ã€ç›¸å…³æ€§ã€å¼‚å¸¸å€¼æ£€æµ‹
- **æ•°æ®è´¨é‡æ£€æŸ¥** - ç¼ºå¤±å€¼ã€é‡å¤å€¼åˆ†æ

### ğŸ› ï¸ æ•°æ®å¤„ç†
- **æ•°æ®æ¸…æ´—** - å»é‡ã€å¡«å……ç¼ºå¤±å€¼
- **æ•°æ®è½¬æ¢** - ç±»å‹è½¬æ¢ã€æ ¼å¼åŒ–
- **æ•°æ®èšåˆ** - åˆ†ç»„ç»Ÿè®¡ã€æ±‡æ€»

### ğŸ“¤ æ•°æ®å¯¼å‡º
- **å¤šæ ¼å¼å¯¼å‡º** - Excelã€CSVã€JSON
- **æŸ¥è¯¢ç»“æœå¯¼å‡º** - æ”¯æŒSQLæŸ¥è¯¢ç»“æœå¯¼å‡º

---

## ğŸ”— æ•°æ®åº“è¿æ¥åŠŸèƒ½

### æ”¯æŒçš„æ•°æ®åº“ç±»å‹

- **MySQL** - å…³ç³»å‹æ•°æ®åº“
- **PostgreSQL** - å…³ç³»å‹æ•°æ®åº“  
- **MongoDB** - æ–‡æ¡£å‹æ•°æ®åº“
- **SQLite** - è½»é‡çº§å…³ç³»å‹æ•°æ®åº“

### è¿æ¥æ–¹å¼

#### æ–¹å¼ä¸€ï¼šé…ç½®æ–‡ä»¶è¿æ¥ï¼ˆæ¨èï¼‰

1. **é…ç½®æ•°æ®åº“ä¿¡æ¯**

ç¼–è¾‘ `config/database_config.json`ï¼š

```json
{
  "databases": {
    "my_mysql": {
      "type": "mysql",
      "host": "localhost",
      "port": 3306,
      "database": "my_database",
      "username": "root",
      "password": "${MYSQL_PASSWORD}",
      "charset": "utf8mb4",
      "description": "æˆ‘çš„MySQLæ•°æ®åº“",
      "enabled": true
    },
    "my_postgres": {
      "type": "postgresql",
      "host": "localhost",
      "port": 5432,
      "database": "my_database",
      "username": "postgres",
      "password": "${POSTGRES_PASSWORD}",
      "schema": "public",
      "description": "æˆ‘çš„PostgreSQLæ•°æ®åº“",
      "enabled": true
    }
  }
}
```

2. **è®¾ç½®ç¯å¢ƒå˜é‡**

ç¼–è¾‘ `.env` æ–‡ä»¶ï¼š

```env
# æ•°æ®åº“å¯†ç 
MYSQL_PASSWORD=your_mysql_password
POSTGRES_PASSWORD=your_postgres_password
MONGO_PASSWORD=your_mongo_password
```

#### æ–¹å¼äºŒï¼šç›´æ¥è¿æ¥

```python
# MySQLè¿æ¥
connect_data_source(
    source_type="mysql",
    config={
        "host": "localhost",
        "port": 3306,
        "database": "test_db",
        "username": "root",  # æ”¯æŒ user æˆ– username
        "password": "password"
    }
)

# PostgreSQLè¿æ¥
connect_data_source(
    source_type="postgresql",
    config={
        "host": "localhost",
        "port": 5432,
        "database": "test_db",
        "username": "postgres",
        "password": "password"
    }
)
```

### æ•°æ®åº“ç®¡ç†

```python
# åˆ—å‡ºæ‰€æœ‰é…ç½®
manage_database_config(action="list")

# æµ‹è¯•è¿æ¥
manage_database_config(
    action="test",
    config={"database_name": "my_mysql"}
)

# æ·»åŠ æ–°é…ç½®
manage_database_config(
    action="add",
    config={
        "database_name": "new_db",
        "database_config": {
            "type": "mysql",
            "host": "192.168.1.100",
            "port": 3306,
            "database": "test_db",
            "username": "user",
            "password": "pass"
        }
    }
)
```

---

## ğŸŒ APIè¿æ¥å™¨åŠŸèƒ½

### æ”¯æŒçš„è®¤è¯æ–¹å¼

- **API Key** - Queryå‚æ•°æˆ–Headeræ–¹å¼
- **Bearer Token** - OAuth 2.0è®¤è¯
- **Basicè®¤è¯** - ç”¨æˆ·å/å¯†ç 
- **è‡ªå®šä¹‰Header** - çµæ´»çš„è®¤è¯å¤´
- **æ— è®¤è¯** - å…¬å¼€API

### APIé…ç½®ç®¡ç†

```python
# æ·»åŠ APIé…ç½®
manage_api_config(
    action="add",
    api_name="weather_api",
    config_data={
        "base_url": "https://api.openweathermap.org/data/2.5",
        "auth_type": "api_key",
        "auth_config": {
            "api_key": "${WEATHER_API_KEY}",
            "key_param": "appid",
            "key_location": "query"
        },
        "endpoints": {
            "current_weather": {
                "path": "/weather",
                "method": "GET",
                "description": "è·å–å½“å‰å¤©æ°”"
            }
        }
    }
)

# åˆ—å‡ºAPIé…ç½®
manage_api_config(action="list")

# è·å–APIç«¯ç‚¹
manage_api_config(action="get_endpoints", api_name="weather_api")
```

### APIæ•°æ®è·å–ä¸å­˜å‚¨

**é‡è¦è¯´æ˜ï¼š** æ‰€æœ‰APIæ•°æ®ç°åœ¨éƒ½ä¼šè‡ªåŠ¨å­˜å‚¨åˆ°æ•°æ®åº“ä¸­ï¼Œæ— éœ€æ‰‹åŠ¨ç®¡ç†å­˜å‚¨æµç¨‹ã€‚

```python
# åŸºæœ¬APIè°ƒç”¨ï¼ˆè‡ªåŠ¨å­˜å‚¨åˆ°æ•°æ®åº“ï¼‰
fetch_api_data(
    api_name="weather_api",
    endpoint_name="current_weather",
    params={"q": "Beijing", "units": "metric"}
)

# å¸¦æ•°æ®è½¬æ¢çš„è°ƒç”¨ï¼ˆè‡ªåŠ¨å­˜å‚¨åˆ°æ•°æ®åº“ï¼‰
fetch_api_data(
    api_name="rest_api",
    endpoint_name="users",
    transform_config={
        "field_mapping": {
            "user_id": "id",
            "user_name": "name"
        },
        "include_fields": ["id", "name", "email"]
    }
)

# é¢„è§ˆAPIæ•°æ®
api_data_preview(
    api_name="weather_api",
    endpoint_name="current_weather",
    params={"q": "Shanghai"},
    max_rows=5
)

# åˆ›å»ºå­˜å‚¨ä¼šè¯ï¼ˆå¯é€‰ï¼Œç”¨äºç»„ç»‡æ•°æ®ï¼‰
create_api_storage_session(
    session_name="weather_data",
    api_name="weather_api",
    endpoint_name="current_weather",
    description="å¤©æ°”æ•°æ®æ”¶é›†"
)
```

**æ•°æ®æµç¨‹ç®€åŒ–ï¼š**
- âœ… **è‡ªåŠ¨å­˜å‚¨**ï¼šæ‰€æœ‰APIæ•°æ®è‡ªåŠ¨å­˜å‚¨åˆ°æ•°æ®åº“
- âœ… **ä¼šè¯ç®¡ç†**ï¼šé€šè¿‡session_idç»„ç»‡å’Œç®¡ç†æ•°æ®
- âœ… **æ•°æ®æŸ¥è¯¢**ï¼šç›´æ¥ä»æ•°æ®åº“æŸ¥è¯¢APIæ•°æ®
- âŒ **æ‰‹åŠ¨å­˜å‚¨**ï¼šå·²åˆ é™¤å¤æ‚çš„æ‰‹åŠ¨å­˜å‚¨æµç¨‹

---

## ğŸ“ æ–‡ä»¶å¯¼å…¥åŠŸèƒ½

### Excelæ–‡ä»¶å¯¼å…¥

```python
connect_data_source(
    source_type="excel",
    config={
        "file_path": "data/sales.xlsx",
        "sheet_name": "Sheet1"  # å¯é€‰ï¼Œé»˜è®¤ç¬¬ä¸€ä¸ªå·¥ä½œè¡¨
    },
    target_table="sales_data"
)
```

### CSVæ–‡ä»¶å¯¼å…¥

```python
connect_data_source(
    source_type="csv",
    config={
        "file_path": "data/customers.csv",
        "encoding": "utf-8"  # å¯é€‰ï¼Œè‡ªåŠ¨æ£€æµ‹
    },
    target_table="customers"
)
```

---

## ğŸ” æ•°æ®æŸ¥è¯¢åŠŸèƒ½

### æœ¬åœ°æ•°æ®æŸ¥è¯¢

```python
# æŸ¥è¯¢æœ¬åœ°SQLiteæ•°æ®
execute_sql(
    query="SELECT * FROM sales_data WHERE amount > 1000",
    limit=100
)

# å¸¦å‚æ•°çš„å®‰å…¨æŸ¥è¯¢
execute_sql(
    query="SELECT * FROM customers WHERE city = %(city)s",
    params={"city": "åŒ—äº¬"},
    limit=50
)
```

### å¤–éƒ¨æ•°æ®åº“æŸ¥è¯¢

```python
# æŸ¥è¯¢MySQLæ•°æ®åº“
query_external_database(
    database_name="my_mysql",
    query="SELECT COUNT(*) as total FROM users",
    limit=1000
)

# æŸ¥è¯¢MongoDB
query_external_database(
    database_name="my_mongo",
    query='[{"$match": {"status": "active"}}, {"$count": "total"}]',
    limit=1000
)
```

---

## ğŸ“Š æ•°æ®åˆ†æåŠŸèƒ½

### åŸºç¡€ç»Ÿè®¡åˆ†æ

```python
# åŸºæœ¬ç»Ÿè®¡ä¿¡æ¯
analyze_data(
    analysis_type="basic_stats",
    table_name="sales_data"
)

# ç›¸å…³æ€§åˆ†æ
analyze_data(
    analysis_type="correlation",
    table_name="sales_data",
    columns=["amount", "quantity", "price"]
)

# å¼‚å¸¸å€¼æ£€æµ‹
analyze_data(
    analysis_type="outliers",
    table_name="sales_data",
    columns=["amount"]
)
```

### æ•°æ®è´¨é‡æ£€æŸ¥

```python
# ç¼ºå¤±å€¼åˆ†æ
analyze_data(
    analysis_type="missing_values",
    table_name="customers"
)

# é‡å¤å€¼æ£€æµ‹
analyze_data(
    analysis_type="duplicates",
    table_name="customers"
)
```

---

## ğŸ› ï¸ æ•°æ®å¤„ç†åŠŸèƒ½

### æ•°æ®æ¸…æ´—

```python
# å»é‡å’Œå¡«å……ç¼ºå¤±å€¼
process_data(
    operation_type="clean",
    data_source="customers",
    config={
        "remove_duplicates": True,
        "fill_missing": {
            "age": {"method": "mean"},
            "city": {"method": "mode"}
        }
    },
    target_table="customers_clean"
)
```

### æ•°æ®ç­›é€‰

```python
# æ¡ä»¶ç­›é€‰
process_data(
    operation_type="filter",
    data_source="sales_data",
    config={
        "filter_condition": "amount > 1000 AND status = 'completed'",
        "select_columns": ["id", "amount", "date"]
    },
    target_table="high_value_sales"
)
```

### æ•°æ®èšåˆ

```python
# åˆ†ç»„ç»Ÿè®¡
process_data(
    operation_type="aggregate",
    data_source="sales_data",
    config={
        "group_by": {
            "columns": ["category", "region"],
            "agg": {
                "amount": ["sum", "mean"],
                "quantity": "count"
            }
        }
    },
    target_table="sales_summary"
)
```

---

## ğŸ“¤ æ•°æ®å¯¼å‡ºåŠŸèƒ½

### å¯¼å‡ºåˆ°Excel

```python
# å¯¼å‡ºè¡¨æ•°æ®
export_data(
    export_type="excel",
    data_source="sales_summary",
    file_path="exports/sales_report.xlsx"
)

# å¯¼å‡ºæŸ¥è¯¢ç»“æœ
export_data(
    export_type="excel",
    data_source="SELECT * FROM customers WHERE city = 'åŒ—äº¬'"
)
```

### å¯¼å‡ºåˆ°CSV

```python
export_data(
    export_type="csv",
    data_source="customers_clean",
    options={
        "encoding": "utf-8-sig",  # æ”¯æŒä¸­æ–‡Excelæ‰“å¼€
        "index": False
    }
)
```

---

## ğŸ“‹ æ•°æ®ä¿¡æ¯æŸ¥è¯¢

### æŸ¥çœ‹æ•°æ®åº“ç»“æ„

```python
# åˆ—å‡ºæ‰€æœ‰è¡¨
get_data_info(info_type="tables")

# æŸ¥çœ‹è¡¨ç»“æ„
get_data_info(
    info_type="schema",
    table_name="sales_data"
)

# æŸ¥çœ‹ç»Ÿè®¡ä¿¡æ¯
get_data_info(
    info_type="stats",
    table_name="sales_data"
)
```

### æŸ¥çœ‹æ•°æ®æº

```python
# åˆ—å‡ºæ‰€æœ‰æ•°æ®æº
list_data_sources()
```

---

## ğŸ¯ æœ€ä½³å®è·µ

### 1. æ•°æ®å¯¼å…¥æµç¨‹

```python
# 1. å¯¼å…¥æ•°æ®
connect_data_source(
    source_type="excel",
    config={"file_path": "data.xlsx"},
    target_table="raw_data"
)

# 2. æ£€æŸ¥æ•°æ®ç»“æ„
get_data_info(info_type="schema", table_name="raw_data")

# 3. æ•°æ®è´¨é‡æ£€æŸ¥
analyze_data(analysis_type="missing_values", table_name="raw_data")
analyze_data(analysis_type="duplicates", table_name="raw_data")

# 4. æ•°æ®æ¸…æ´—
process_data(
    operation_type="clean",
    data_source="raw_data",
    config={"remove_duplicates": True},
    target_table="clean_data"
)

# 5. æ•°æ®åˆ†æ
analyze_data(analysis_type="basic_stats", table_name="clean_data")

# 6. å¯¼å‡ºç»“æœ
export_data(export_type="excel", data_source="clean_data")
```

### 2. æ•°æ®åº“è¿æ¥æœ€ä½³å®è·µ

- ä½¿ç”¨é…ç½®æ–‡ä»¶ç®¡ç†æ•°æ®åº“è¿æ¥
- å°†æ•æ„Ÿä¿¡æ¯ï¼ˆå¯†ç ï¼‰å­˜å‚¨åœ¨ç¯å¢ƒå˜é‡ä¸­
- å®šæœŸæµ‹è¯•æ•°æ®åº“è¿æ¥çŠ¶æ€
- ä½¿ç”¨ä¸´æ—¶é…ç½®è¿›è¡Œå¿«é€Ÿæµ‹è¯•

### 3. APIæ•°æ®è·å–æœ€ä½³å®è·µ

- å…ˆé¢„è§ˆAPIæ•°æ®ç»“æ„
- ä½¿ç”¨æ•°æ®è½¬æ¢é…ç½®æ ‡å‡†åŒ–å­—æ®µ
- å¯¹é‡è¦æ•°æ®å¯ç”¨æŒä¹…åŒ–å­˜å‚¨
- åˆç†è®¾ç½®è¯·æ±‚é¢‘ç‡å’Œè¶…æ—¶æ—¶é—´

---

## âš ï¸ æ³¨æ„äº‹é¡¹

### å®‰å…¨æ€§

- ä¸è¦åœ¨ä»£ç ä¸­ç¡¬ç¼–ç å¯†ç å’ŒAPIå¯†é’¥
- ä½¿ç”¨ç¯å¢ƒå˜é‡ç®¡ç†æ•æ„Ÿä¿¡æ¯
- å®šæœŸæ›´æ–°æ•°æ®åº“å¯†ç å’ŒAPIå¯†é’¥

### æ€§èƒ½ä¼˜åŒ–

- å¤§æ•°æ®é‡æŸ¥è¯¢æ—¶ä½¿ç”¨ `limit` å‚æ•°
- åˆç†ä½¿ç”¨ç´¢å¼•æé«˜æŸ¥è¯¢æ€§èƒ½
- å®šæœŸæ¸…ç†ä¸´æ—¶é…ç½®å’Œç¼“å­˜æ•°æ®

### é”™è¯¯å¤„ç†

- ä»”ç»†é˜…è¯»å·¥å…·è¿”å›çš„é”™è¯¯ä¿¡æ¯
- æ£€æŸ¥æ•°æ®åº“è¿æ¥çŠ¶æ€
- éªŒè¯SQLè¯­æ³•å’Œå‚æ•°æ ¼å¼

---

## ğŸ†˜ å¸¸è§é—®é¢˜è§£å†³

### æ•°æ®åº“è¿æ¥é—®é¢˜

**é—®é¢˜**: è¿æ¥å¤±è´¥ï¼Œæç¤º"ç¼ºå°‘å¿…éœ€çš„é…ç½®å­—æ®µ"
**è§£å†³**: æ£€æŸ¥ç”¨æˆ·åå‚æ•°ï¼Œæ”¯æŒ `user` æˆ– `username`

**é—®é¢˜**: ä¸´æ—¶é…ç½®ä¸å­˜åœ¨
**è§£å†³**: ä½¿ç”¨ `list_data_sources()` æŸ¥çœ‹å¯ç”¨é…ç½®

### APIè¿æ¥é—®é¢˜

**é—®é¢˜**: APIè®¤è¯å¤±è´¥
**è§£å†³**: æ£€æŸ¥APIå¯†é’¥å’Œè®¤è¯é…ç½®

**é—®é¢˜**: æ•°æ®æ ¼å¼è§£æé”™è¯¯
**è§£å†³**: ä½¿ç”¨ `api_data_preview` å…ˆæŸ¥çœ‹æ•°æ®ç»“æ„

### æ•°æ®å¤„ç†é—®é¢˜

**é—®é¢˜**: SQLè¯­æ³•é”™è¯¯
**è§£å†³**: ä½¿ç”¨å‚æ•°åŒ–æŸ¥è¯¢é¿å…è¯­æ³•é—®é¢˜

**é—®é¢˜**: å†…å­˜ä¸è¶³
**è§£å†³**: ä½¿ç”¨ `limit` å‚æ•°é™åˆ¶ç»“æœé›†å¤§å°

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·ï¼š

1. æŸ¥çœ‹æœ¬æ‰‹å†Œç›¸å…³ç« èŠ‚
2. æ£€æŸ¥å·¥å…·è¿”å›çš„é”™è¯¯ä¿¡æ¯
3. æäº¤Issueæˆ–è”ç³»å¼€å‘å›¢é˜Ÿ

---

**ç‰ˆæœ¬**: v1.0.0  
**æ›´æ–°æ—¥æœŸ**: 2025å¹´1æœˆ24æ—¥  
**æ–‡æ¡£çŠ¶æ€**: âœ… å®Œæ•´ç‰ˆ